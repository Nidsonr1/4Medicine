generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Patient {
  id           String   @id @default(uuid())
  name         String
  cpf          String
  email        String
  password     String
  gender       String
  cell         String
  dateOfBirth  String
  zipCode      String
  city         String
  uf           String
  neighborhood String
  street       String
  complement   String?  @default("")
  number       Int
  createdAt    DateTime @default(now())

  Appointment       Appointment[]
  Reports           Reports[]
  PatientHealthInfo PatientHealthInfo[]
  Exams             Exams[]

  @@map("patients")
}

model PatientHealthInfo {
  id        String   @id @default(uuid())
  condition String[]
  allergies String[]

  patient    Patient @relation(fields: [patient_id], references: [id])
  patient_id String
}

model Expertise {
  id   String @id @default(uuid())
  name String
}

model Agreement {
  id   String @id @default(uuid())
  name String
}

model Doctor {
  id          String        @id @default(uuid())
  name        String
  CRM         String
  password    String
  expertise   String[]
  phone       String
  cell        String?       @default("null")
  agreement   String[]
  Appointment Appointment[]
  Reports     Reports[]
  Exams       Exams[]

  @@map("doctors")
}

model Reports {
  id         String   @id @default(uuid())
  document   String
  sharedBy   String[]
  created_at DateTime @default(now())

  patient    Patient @relation(fields: [patient_id], references: [id])
  patient_id String

  doctor    Doctor @relation(fields: [doctor_id], references: [id])
  doctor_id String

  @@map("reports")
}

model Exams {
  id         String   @id @default(uuid())
  document   String
  sharedBy   String[]
  created_at DateTime @default(now())

  patient    Patient @relation(fields: [patient_id], references: [id])
  patient_id String

  doctor    Doctor @relation(fields: [doctor_id], references: [id])
  doctor_id String

  @@map("exams")
}

model Appointment {
  id          String   @id @default(uuid())
  title       String
  start_date  DateTime
  end_date    DateTime
  description String?
  link        String

  doctor    Doctor? @relation(fields: [doctor_id], references: [id])
  doctor_id String

  patient    Patient? @relation(fields: [patient_id], references: [id])
  patient_id String

  @@map("appointments")
}
